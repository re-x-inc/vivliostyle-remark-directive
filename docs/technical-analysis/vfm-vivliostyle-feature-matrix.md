# VFM・Vivliostyle 機能サポート状況比較表

## 各 Document Processor の機能サポート状況

| 機能                           | VFM (基準) | vfm-exact | custom-vfm | vfm-replace | wrapper-class | proxy    | その他 |
| ------------------------------ | ---------- | --------- | ---------- | ----------- | ------------- | -------- | ------ |
| **基本機能**                   |
| Markdown → HTML 変換           | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ✅     |
| GFM 拡張構文                   | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | 一部   |
| ハードラインブレーク           | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| **フロントマター**             |
| YAML 解析                      | ✅         | ✅        | ⚠️         | ⚠️          | ✅            | ✅       | ❌     |
| メタデータ抽出                 | ✅         | ✅        | ❌         | ❌          | ❌            | ❌       | ❌     |
| `<head>`への反映               | ✅         | ✅        | ❌         | ❌          | ❌            | ❌       | ❌     |
| **ドキュメント構造**           |
| 完全な HTML 生成               | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| セクション構造化               | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| 見出し ID 自動付与             | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| aria-labelledby                | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| **拡張構文**                   |
| 数式 (`$...$`)                 | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| ルビ (`{振り仮名}^(ふりがな)`) | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| 脚注                           | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| 属性付与                       | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| **メディア処理**               |
| 画像の`<figure>`化             | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| キャプション生成               | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| **コード処理**                 |
| シンタックスハイライト         | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| 言語クラス付与                 | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ✅     |
| **特殊機能**                   |
| 目次ショートコード `[[toc]]`   | ✅         | ✅        | ✅         | ✅          | ✅            | ✅       | ❌     |
| replace オプション             | ✅         | ✅        | ❌         | ✅          | ✅            | ✅       | ❌     |
| **カスタム機能**               |
| remark-directive               | ❌         | ✅        | ✅         | 部分的      | ✅            | ✅       | ✅     |
| **パフォーマンス**             |
| 処理速度                       | 基準       | やや遅い  | 遅い       | 速い        | やや遅い      | やや遅い | 速い   |

## 凡例

- ✅ 完全サポート
- ⚠️ 部分的サポート/条件付き
- ❌ 未サポート

## 結論

### 最も網羅的なサポート: `document-processor-vfm-exact.js`

- VFM のすべての機能を維持
- remark-directive も完全サポート
- フロントマター処理も正常動作

### 推奨事項

1. **本番環境**: `document-processor-vfm-exact.js`を使用
2. **シンプルな用途**: `document-processor-vfm-replace.js`も検討可能（ただし複雑な directive は非対応）
3. **カスタマイズ重視**: `document-processor-vfm-wrapper-class.js`で拡張性を確保

## 重要な注意点

### フロントマター処理

VFM は以下の処理を自動で行います：

```yaml
---
title: ドキュメントタイトル
author: 著者名
date: 2024-01-15
lang: ja
---
```

↓

```html
<html lang="ja">
  <head>
    <title>ドキュメントタイトル</title>
    <meta name="author" content="著者名" />
    <!-- その他のメタデータ -->
  </head>
</html>
```

### Vivliostyle 固有のメタデータ

```yaml
---
vfm:
  theme:
    - "@vivliostyle/theme-bunko"
  math: true
  toc:
    title: "目次"
    depth: 3
---
```

これらの機能をすべてサポートしているのは、VFM を完全に活用している実装のみです。
